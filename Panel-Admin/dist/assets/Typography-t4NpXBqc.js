import{r as s,j as e,B as g,k as l,F as j,I as y,S as A,c as F}from"./index-JOrpMNhF.js";import{M as m,a as h}from"./axios-ChMsnGDK.js";import{d as E,D as M,a as R,b as V,c as _,e as G}from"./DataGrid-DR8JU-SN.js";import"./Checkbox-DNkkIThj.js";const O=[{field:"NomLiquide",headerName:"Liquide",width:150,editable:!0},{field:"BaseQte",headerName:"Qte Base",width:110,editable:!0},{field:"AromeQte",headerName:"Qte Arome",type:"number",width:110,editable:!0},{field:"BasePrice",headerName:"Prix Base",type:"number",width:110,editable:!0},{field:"AromePrice",headerName:"Prix Arome",type:"number",width:110,editable:!0},{field:"FlaconPrice",headerName:"Prix Flacon",type:"number",width:110,editable:!0},{field:"LiquideVolum",headerName:"Volume Liquide",type:"number",width:110,editable:!0},{field:"NbrFlacon",headerName:"Nbr Flacon",type:"number",width:110,editable:!0},{field:"TypeLiquide",headerName:"Type Liquide",width:150,editable:!0},{field:"PriceUnit",headerName:"Prix Unitaire",type:"number",width:110,editable:!0},{field:"Total",headerName:"Total",type:"number",width:110,editable:!0},{field:"created_at",headerName:"created_at",width:150,editable:!0}];function K(){const[N,B]=s.useState([]),[p,v]=s.useState(""),[a,x]=s.useState({NomLiquide:"",TypeLiquide:"",BaseQte:"",AromeQte:"",BasePrice:"",AromePrice:"",PriceUnit:"",Total:""}),[C,d]=s.useState(!1),b=async()=>{try{const i=(await h.get("http://127.0.0.1:4000/StockController/selectAllLiquide")).data.map((r,n)=>({...r,id:r.ID_Stock||`id-${n}`}));B(i)}catch(t){console.error("Error fetching data:",t)}};s.useEffect(()=>{b()},[]);const Q=async()=>{try{const t=await h.get("http://127.0.0.1:4000/StockFlacon/selectAllFlacon"),{nbrFlaconEmpty:i,avgPriceUnitFlacon:r}=t.data,n=parseFloat(a.BaseQte)||0,f=parseFloat(a.AromeQte)||0,w=parseFloat(a.BasePrice)||0,u=parseFloat(a.AromePrice)||0,L=n+f,c=Math.ceil(L/30),k=n/1e3,q=w*k,D=((q+u+r*c)/c).toFixed(2),U=q+u+r*c,I={...a,BaseQte:n,AromeQte:f,BasePrice:w,AromePrice:u,LiquideVolum:L,NbrFlacon:c,PriceUnit:D,Total:U},P=await h.post("http://127.0.0.1:4000/StockController/InsertStock",I);d(!1),x({NomLiquide:"",TypeLiquide:"",BaseQte:"",AromeQte:"",BasePrice:"",AromePrice:"",PriceUnit:"",Total:""}),b(),window.alert(`Rest Flacon: ${P.data.restFlacon}, Total Flacon: ${P.data.TotalFlacon}`)}catch(t){console.error("Error inserting liquide:",t)}},S=t=>{v(t.target.value)},o=t=>{const{name:i,value:r}=t.target;x({...a,[i]:r})},T=N.filter(t=>t.NomLiquide.toLowerCase().includes(p.toLowerCase()));return e.jsxs(g,{sx:{height:700,width:"100%",background:"white"},children:[e.jsxs(g,{component:"form",sx:{display:"flex",alignItems:"center","& > :not(style)":{m:1}},noValidate:!0,autoComplete:"off",children:[e.jsx(l,{id:"search",label:"Search",variant:"standard",value:p,onChange:S}),e.jsx(E,{sx:{cursor:"pointer"},onClick:()=>d(!0)})]}),e.jsxs(M,{open:C,onClose:()=>d(!1),children:[e.jsx(R,{children:"Add New Liquide"}),e.jsxs(V,{children:[e.jsx(l,{label:"Nom Liquide",name:"NomLiquide",value:a.NomLiquide,onChange:o,variant:"outlined",sx:{mb:1,width:"80%"}}),e.jsxs(j,{fullWidth:!0,sx:{mb:1},children:[e.jsx(y,{children:"Type Liquide"}),e.jsxs(A,{label:"Type Liquide",name:"TypeLiquide",value:a.TypeLiquide,onChange:o,variant:"outlined",sx:{mb:1,width:"80%"},children:[e.jsx(m,{value:"Fruite",children:"FruitÃ©"}),e.jsx(m,{value:"Gourmand",children:"Gourmand"})]})]}),e.jsx(l,{label:"Base Qte",name:"BaseQte",value:a.BaseQte,onChange:o,variant:"outlined",sx:{mb:1,width:"80%"}}),e.jsxs(j,{fullWidth:!0,sx:{mb:1},children:[e.jsx(y,{children:"Arome Qte"}),e.jsx(A,{label:"Arome Qte",name:"AromeQte",value:a.AromeQte,onChange:o,variant:"outlined",sx:{mb:1,width:"80%"},children:[...Array(10)].map((t,i)=>e.jsx(m,{value:i+1,children:i+1},i+1))})]}),e.jsx(l,{label:"Base Price",name:"BasePrice",value:a.BasePrice,onChange:o,variant:"outlined",sx:{mb:1,width:"80%"}}),e.jsx(l,{label:"Arome Price",name:"AromePrice",value:a.AromePrice,onChange:o,variant:"outlined",sx:{mb:1,width:"80%"}})]}),e.jsxs(_,{children:[e.jsx(F,{onClick:()=>d(!1),children:"Cancel"}),e.jsx(F,{onClick:Q,variant:"contained",color:"primary",children:"Add"})]})]}),e.jsx(G,{rows:T,columns:O,initialState:{pagination:{paginationModel:{pageSize:10}}},pageSizeOptions:[20],checkboxSelection:!0,disableRowSelectionOnClick:!0})]})}export{K as default};
